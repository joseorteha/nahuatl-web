# ๐จ Diagrama de Flujo - Sistema de Lecciones

## ๐ Flujo Completo del Sistema

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    PROFESOR CREA CURSO                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    PROFESOR CREA MรDULO                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
                    โโโโโโโโโโโโโโโโโโโ
                    โ Agregar Lecciรณn โ
                    โโโโโโโโโโโโโโโโโโโ
                              โ
                โโโโโโโโโโโโโโโดโโโโโโโโโโโโโโ
                โผ                           โผ
    โโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโ
    โ VINCULAR EXISTENTE    โ   โ CREAR EXCLUSIVA       โ
    โโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโ
                โ                           โ
                โผ                           โผ
    โโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโ
    โ Buscar en catรกlogo    โ   โ Formulario completo   โ
    โ - Filtros             โ   โ - Tรญtulo              โ
    โ - Categorรญa           โ   โ - Contenido           โ
    โ - Nivel               โ   โ - Recursos            โ
    โ - Bรบsqueda            โ   โ - Quiz                โ
    โโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโ
                โ                           โ
                โผ                           โผ
    โโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโ
    โ Seleccionar lecciรณn   โ   โ Guardar como:         โ
    โ Configurar:           โ   โ - es_publica = false  โ
    โ - Orden               โ   โ - es_exclusiva = true โ
    โ - Obligatoria         โ   โ - modulo_id = X       โ
    โ - Puntos requeridos   โ   โโโโโโโโโโโโโโโโโโโโโโโโโ
    โโโโโโโโโโโโโโโโโโโโโโโโโ               โ
                โ                           โ
                โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
                              โผ
                โโโโโโโโโโโโโโโโโโโโโโโโโโโ
                โ LECCIรN EN MรDULO       โ
                โ (modulos_lecciones)     โ
                โโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐จโ๐ Flujo del Estudiante

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  ESTUDIANTE INSCRITO EN CURSO                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
                    โโโโโโโโโโโโโโโโโโโ
                    โ  Ve el Mรณdulo   โ
                    โโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  Lista de Lecciones del Mรณdulo          โ
        โ                                         โ
        โ  โ Lecciรณn 1 (Completada)              โ
        โ  โ Lecciรณn 2 (En progreso)             โ
        โ  ๐ Lecciรณn 3 (Bloqueada)              โ
        โ  ๐ Lecciรณn 4 (Exclusiva del mรณdulo)   โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
                    โโโโโโโโโโโโโโโโโโโ
                    โ Click en lecciรณnโ
                    โโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  URL: /lecciones/[id]?from=modulo       โ
        โ       &moduloId=X&cursoId=Y             โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  Registrar Progreso:                    โ
        โ  - contexto_acceso = 'modulo'           โ
        โ  - modulo_id = X                        โ
        โ  - curso_id = Y                         โ
        โ  - estado = 'en_progreso'               โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  Estudiante completa la lecciรณn         โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  Actualizar Progreso:                   โ
        โ  - estado = 'completada'                โ
        โ  - fecha_completada = now()             โ
        โ  - puntuacion_quiz = X                  โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  Click "Salir"                          โ
        โ  โ Vuelve al mรณdulo (no a /lecciones)   โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ Flujo de Progreso Compartido

```
ESCENARIO: Lecciรณn "Nรบmeros 1-10" estรก en 2 mรณdulos diferentes

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  MรDULO A (Curso Bรกsico)                                        โ
โ  - Lecciรณn: "Nรบmeros 1-10"                                      โ
โ  - Orden: 3                                                     โ
โ  - Obligatoria: Sรญ                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  Estudiante completa en Mรณdulo A        โ
        โ  โ Progreso guardado                    โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  progreso_lecciones:                                            โ
โ  - usuario_id: 123                                              โ
โ  - leccion_id: 456                                              โ
โ  - estado: 'completada' โ                                      โ
โ  - contexto_acceso: 'modulo'                                    โ
โ  - modulo_id: A                                                 โ
โ  - curso_id: Bรกsico                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  Estudiante se inscribe en Curso        โ
        โ  Intermedio que tambiรฉn tiene           โ
        โ  "Nรบmeros 1-10" en Mรณdulo B             โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  MรDULO B (Curso Intermedio)                                    โ
โ  - Lecciรณn: "Nรบmeros 1-10"                                      โ
โ  - Orden: 1                                                     โ
โ  - Obligatoria: No                                              โ
โ  - Badge: "โ Ya completada" โ DETECTA PROGRESO EXISTENTE      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  Si accede desde Mรณdulo B:              โ
        โ  โ Actualiza contexto a Mรณdulo B        โ
        โ  โ Mantiene estado 'completada'         โ
        โ  โ Puede revisar contenido              โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฏ Tipos de Lecciones

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                        LECCIรN PรBLICA                          โ
โ                                                                 โ
โ  es_publica = true                                              โ
โ  es_exclusiva_modulo = false                                    โ
โ  modulo_exclusivo_id = null                                     โ
โ                                                                 โ
โ  โ Aparece en /lecciones                                       โ
โ  โ Puede vincularse a mรบltiples mรณdulos                        โ
โ  โ Puede completarse independientemente                        โ
โ  โ NO se elimina con el mรณdulo                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                      LECCIรN EXCLUSIVA                          โ
โ                                                                 โ
โ  es_publica = false                                             โ
โ  es_exclusiva_modulo = true                                     โ
โ  modulo_exclusivo_id = UUID                                     โ
โ                                                                 โ
โ  โ NO aparece en /lecciones                                    โ
โ  โ NO puede vincularse a otros mรณdulos                         โ
โ  โ Solo visible en su mรณdulo                                   โ
โ  โ Se elimina si se elimina el mรณdulo                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                       LECCIรN PRIVADA                           โ
โ                                                                 โ
โ  es_publica = false                                             โ
โ  es_exclusiva_modulo = false                                    โ
โ  modulo_exclusivo_id = null                                     โ
โ                                                                 โ
โ  โ NO aparece en /lecciones                                    โ
โ  โ Puede vincularse a mรบltiples mรณdulos                        โ
โ  โ รtil para lecciones "borrador" compartidas                  โ
โ  โ NO se elimina con el mรณdulo                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐๏ธ Estructura de Datos

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                          LECCIONES                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ id                    uuid                                      โ
โ titulo                text                                      โ
โ contenido_texto       text                                      โ
โ profesor_id           uuid                                      โ
โ es_publica            boolean  โ NUEVO                          โ
โ es_exclusiva_modulo   boolean  โ NUEVO                          โ
โ modulo_exclusivo_id   uuid     โ NUEVO                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โ muchos a muchos
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     MODULOS_LECCIONES                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ id                    uuid                                      โ
โ modulo_id             uuid  โโโโโโโ                             โ
โ leccion_id            uuid  โโโโโโโผโโโ LECCIONES               โ
โ orden_en_modulo       integer     โ                             โ
โ es_obligatoria        boolean     โ                             โ
โ puntos_requeridos     integer     โ                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                    โ
                                    โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                          MODULOS                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ id                    uuid                                      โ
โ curso_id              uuid                                      โ
โ titulo                text                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    PROGRESO_LECCIONES                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ id                    uuid                                      โ
โ usuario_id            uuid                                      โ
โ leccion_id            uuid                                      โ
โ estado_leccion        text                                      โ
โ contexto_acceso       text     โ NUEVO ('catalogo'|'modulo')   โ
โ modulo_id             uuid     โ NUEVO                          โ
โ curso_id              uuid     โ NUEVO                          โ
โ fecha_completada      timestamp                                 โ
โ puntuacion_quiz       integer                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ Reglas de Negocio

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  REGLA 1: Lecciones exclusivas                                  โ
โ                                                                 โ
โ  IF es_exclusiva_modulo = true THEN                             โ
โ    - modulo_exclusivo_id MUST NOT BE NULL                       โ
โ    - es_publica MUST BE false                                   โ
โ    - NO puede vincularse a otros mรณdulos                        โ
โ    - Se elimina en CASCADE si se elimina el mรณdulo              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  REGLA 2: Progreso รบnico por usuario-lecciรณn                    โ
โ                                                                 โ
โ  - Solo UN registro por (usuario_id, leccion_id)                โ
โ  - Se actualiza el contexto en cada acceso                      โ
โ  - El estado NO retrocede (completada โ en_progreso โ)         โ
โ  - Se comparte entre todos los mรณdulos                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  REGLA 3: Navegaciรณn contextual                                 โ
โ                                                                 โ
โ  - Siempre pasar parรกmetros: from, moduloId, cursoId            โ
โ  - Botรณn "Salir" vuelve al contexto de origen                   โ
โ  - Breadcrumbs reflejan el contexto actual                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  REGLA 4: Vinculaciรณn de lecciones                              โ
โ                                                                 โ
โ  - Lecciones pรบblicas: pueden vincularse N veces                โ
โ  - Lecciones exclusivas: NO pueden vincularse                   โ
โ  - Lecciones privadas: pueden vincularse N veces                โ
โ  - UNIQUE constraint: (modulo_id, leccion_id)                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฑ Interfaz de Usuario

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  PรGINA: /profesor/cursos/[id]/modulos/[moduloId]              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                 โ
โ  ๐ Mรณdulo 1: Saludos Bรกsicos                                   โ
โ                                                                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ  Lecciones del Mรณdulo                    [โ Agregar]   โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค   โ
โ  โ  1. ๐ Saludos formales (Pรบblica)           [โฏ]        โ   โ
โ  โ     15 min โข 45 estudiantes completaron                 โ   โ
โ  โ                                                         โ   โ
โ  โ  2. ๐ Introducciรณn al mรณdulo (Exclusiva)   [โฏ]        โ   โ
โ  โ     10 min โข Solo en este mรณdulo                        โ   โ
โ  โ                                                         โ   โ
โ  โ  3. ๐ Despedidas (Pรบblica)                 [โฏ]        โ   โ
โ  โ     12 min โข 38 estudiantes completaron                 โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  MODAL: Agregar Lecciรณn                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                 โ
โ  [๐ Vincular Existente] [โจ Crear Exclusiva]                   โ
โ                                                                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ  ๐ Buscar lecciones...                                 โ   โ
โ  โ                                                         โ   โ
โ  โ  [Categorรญa โผ] [Nivel โผ]                               โ   โ
โ  โ                                                         โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ   โ
โ  โ  โ ๐ Nรบmeros del 1 al 10                            โ โ   โ
โ  โ  โ Aprende a contar en nรกhuatl                       โ โ   โ
โ  โ  โ [numeros] [principiante] โฑ๏ธ 20 min    [Vincular] โ โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ   โ
โ  โ                                                         โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ   โ
โ  โ  โ ๐ Colores bรกsicos                                โ โ   โ
โ  โ  โ Los colores en la naturaleza                      โ โ   โ
โ  โ  โ [colores] [principiante] โฑ๏ธ 15 min    [Vincular] โ โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โ Resumen Visual

```
ANTES (Problema):
โ Lecciones solo en catรกlogo
โ No se podรญan reutilizar
โ Navegaciรณn confusa
โ Progreso se perdรญa

DESPUรS (Soluciรณn):
โ Lecciones pรบblicas + exclusivas
โ Reutilizaciรณn inteligente
โ Navegaciรณn contextual
โ Progreso compartido
โ Sistema escalable
```

---

**ยกSistema completo y listo para implementar!** ๐
